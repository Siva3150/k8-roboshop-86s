apiVersion: v1 
kind: ConfigMap 
metadata: 
 name: catalogue 
 namespace: roboshop 
data: 
 MONGO: "true" 
 MONGO_URL: "mongodb://mongodb:27017/catalogue"
---
apiVersion: apps/v1 
kind: Deployment 
metadata: 
 name: catalogue 
 namespace: roboshop
 labels: 
 # these are replica set labels 
  project: roboshop
  component: mongodb
  tier: db 
spec:
 replicas: 1 
 selector: 
  matchLabels:
  # these labels are used to select pods
    project: roboshop
    component: mongodb
    tier: db 
 template: 
  metadata:
   labels:
    project: roboshop
    component: mongodb
    tier: db 
  spec:
   containers: 
    - name: catalogue 
      image: siva3150/catalogue:v1 
      imagePullPolicy: Always 
      envFrom: 
      - ConfigMapRef: 
         name: catalogue 
      ports:
       - name: liveness-port
         containerPort: 8080
      readinessProbe:
        httpGet:
          path: /health
          port: liveness-port
        failureThreshold: 1
        periodSeconds: 15
      livenessProbe:
        httpGet:
          path: /health
          port: liveness-port
        failureThreshold: 1
        periodSeconds: 15

--- 
 apiVersion: v1 
 kind: Service 
 metadata: 
  name: catalogue 
  namespace: roboshop 
 spec: 
  selector: 
   project: roboshop
   component: mongodb
   tier: db 
  ports:
   - protocol: TCP 
     port: 8080 # service port 
     targetPort: 8080 # container port 


     
   
   
  
  